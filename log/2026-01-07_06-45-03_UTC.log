Using device: cuda
============================================================
🎯 训练策略：使用生成数据训练，真实数据测试
============================================================

🔧 生成训练数据...
生成了 2000 张训练图像
训练数据形状: torch.Size([2000, 1024])

📂 加载真实测试数据...
加载了 250 张真实测试图像
测试数据形状: torch.Size([250, 1024])

📊 参数设置:
  输入维度: 1024
  压缩维度: 256
  压缩率: 0.250 (4:1)
  批大小: 32
  训练轮数: 2000
  学习率: 1e-05
  学习率调整: True
  网络层数: 6
  隐藏层维度: 512
  预测层维度: 512
检测到旧版本 PyTorch，使用无 verbose 参数的学习率调度器

🚀 开始训练（使用生成数据）...
Epoch 50/2000, Loss: 0.020782, Recon Loss: 0.020477, LR: 0.000010
Epoch 100/2000, Loss: 0.014822, Recon Loss: 0.014443, LR: 0.000010
Epoch 150/2000, Loss: 0.009370, Recon Loss: 0.009048, LR: 0.000010
Epoch 200/2000, Loss: 0.008008, Recon Loss: 0.007640, LR: 0.000010
Epoch 250/2000, Loss: 0.007062, Recon Loss: 0.006669, LR: 0.000010
Epoch 300/2000, Loss: 0.006045, Recon Loss: 0.005610, LR: 0.000010
Epoch 350/2000, Loss: 0.005774, Recon Loss: 0.005371, LR: 0.000010
Epoch 400/2000, Loss: 0.005466, Recon Loss: 0.005058, LR: 0.000010
Epoch 450/2000, Loss: 0.004352, Recon Loss: 0.004019, LR: 0.000010
Epoch 500/2000, Loss: 0.004367, Recon Loss: 0.004010, LR: 0.000010
Epoch 504: 学习率调整为 0.000005
Epoch 550/2000, Loss: 0.004911, Recon Loss: 0.004543, LR: 0.000005
Epoch 571: 学习率调整为 0.000003
Epoch 600/2000, Loss: 0.004344, Recon Loss: 0.003991, LR: 0.000003
Epoch 622: 学习率调整为 0.000001
Epoch 650/2000, Loss: 0.003793, Recon Loss: 0.003514, LR: 0.000001
Epoch 673: 学习率调整为 0.000001
Epoch 700/2000, Loss: 0.003726, Recon Loss: 0.003420, LR: 0.000001
Epoch 724: 学习率调整为 0.000000
Epoch 750/2000, Loss: 0.003528, Recon Loss: 0.003238, LR: 0.000000
Epoch 775: 学习率调整为 0.000000
Epoch 800/2000, Loss: 0.004555, Recon Loss: 0.004233, LR: 0.000000
Epoch 826: 学习率调整为 0.000000
Epoch 850/2000, Loss: 0.004300, Recon Loss: 0.003991, LR: 0.000000
Epoch 900/2000, Loss: 0.003748, Recon Loss: 0.003464, LR: 0.000000
Epoch 904: 学习率调整为 0.000000
Epoch 950/2000, Loss: 0.004715, Recon Loss: 0.004375, LR: 0.000000
Epoch 955: 学习率调整为 0.000000
Epoch 1000/2000, Loss: 0.004029, Recon Loss: 0.003731, LR: 0.000000
Epoch 1050/2000, Loss: 0.003916, Recon Loss: 0.003607, LR: 0.000000
Epoch 1100/2000, Loss: 0.003733, Recon Loss: 0.003441, LR: 0.000000
Epoch 1150/2000, Loss: 0.003663, Recon Loss: 0.003355, LR: 0.000000
Epoch 1200/2000, Loss: 0.004049, Recon Loss: 0.003718, LR: 0.000000
Epoch 1250/2000, Loss: 0.004023, Recon Loss: 0.003714, LR: 0.000000
Epoch 1300/2000, Loss: 0.003869, Recon Loss: 0.003592, LR: 0.000000
Epoch 1350/2000, Loss: 0.003970, Recon Loss: 0.003645, LR: 0.000000
Epoch 1400/2000, Loss: 0.003703, Recon Loss: 0.003435, LR: 0.000000
Epoch 1450/2000, Loss: 0.004117, Recon Loss: 0.003760, LR: 0.000000
Epoch 1500/2000, Loss: 0.004213, Recon Loss: 0.003854, LR: 0.000000
Epoch 1550/2000, Loss: 0.004048, Recon Loss: 0.003713, LR: 0.000000
Epoch 1600/2000, Loss: 0.003566, Recon Loss: 0.003276, LR: 0.000000
Epoch 1650/2000, Loss: 0.003482, Recon Loss: 0.003217, LR: 0.000000
Epoch 1700/2000, Loss: 0.004474, Recon Loss: 0.004146, LR: 0.000000
Epoch 1750/2000, Loss: 0.003482, Recon Loss: 0.003221, LR: 0.000000
Epoch 1800/2000, Loss: 0.003588, Recon Loss: 0.003305, LR: 0.000000
Epoch 1850/2000, Loss: 0.003944, Recon Loss: 0.003628, LR: 0.000000
Epoch 1900/2000, Loss: 0.003994, Recon Loss: 0.003667, LR: 0.000000
Epoch 1950/2000, Loss: 0.003779, Recon Loss: 0.003498, LR: 0.000000
Epoch 2000/2000, Loss: 0.004055, Recon Loss: 0.003696, LR: 0.000000

训练完成，学习率共调整了 9 次
最佳损失: 0.003159
加载最佳模型进行测试...

📈 绘制训练损失曲线...
Loss curves saved to assets/loss_curves_4Lr[True]n6h512ph512E2000.png

============================================================
🧪 开始测试（使用真实数据）...
============================================================
测试数据维度: torch.Size([250, 1024])
压缩后维度: torch.Size([250, 256])
压缩率: 0.250

📊 整体测试结果:
  重建 MAE: 0.165077
  重建 MSE: 0.060116
  PSNR: 12.21 dB

📸 生成可视化对比图（真实数据 vs 重建结果）...
Loss curves saved to assets/Example_4Lr[True]n6h512ph512E2000.png

📈 每张测试图像的详细指标:
  图像 1: PSNR = 14.94 dB, MAE = 0.127906, MSE = 0.032040
  图像 2: PSNR = 15.10 dB, MAE = 0.126360, MSE = 0.030919
  图像 3: PSNR = 13.05 dB, MAE = 0.157095, MSE = 0.049523
  图像 4: PSNR = 18.22 dB, MAE = 0.089380, MSE = 0.015072
  图像 5: PSNR = 13.50 dB, MAE = 0.152224, MSE = 0.044655

============================================================
✅ 测试完成！
  训练数据: 2000 张生成图像
  测试数据: 250 张真实图像
  压缩效果: 1024 维 → 256 维
  最佳模型已保存到: models/best_model.pth
============================================================
