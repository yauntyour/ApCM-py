Using device: cuda
============================================================
🎯 训练策略：使用生成数据训练，真实数据测试
============================================================

🔧 生成训练数据...
生成了 2000 张训练图像
训练数据形状: torch.Size([2000, 1024])

📂 加载真实测试数据...
加载了 250 张真实测试图像
测试数据形状: torch.Size([250, 1024])

📊 参数设置:
  输入维度: 1024
  压缩维度: 256
  压缩率: 0.250 (4:1)
  批大小: 32
  训练轮数: 2000
  学习率: 0.001
  学习率调整: True
  网络层数: 12
  隐藏层维度: 512
  预测层维度: 512
检测到旧版本 PyTorch，使用无 verbose 参数的学习率调度器

🚀 开始训练（使用生成数据）...
Epoch 50/2000, Loss: 0.005344, Recon Loss: 0.005026, LR: 0.001000
Epoch 100/2000, Loss: 0.003400, Recon Loss: 0.003190, LR: 0.001000
Epoch 150/2000, Loss: 0.002715, Recon Loss: 0.002563, LR: 0.001000
Epoch 200/2000, Loss: 0.002361, Recon Loss: 0.002237, LR: 0.001000
Epoch 250/2000, Loss: 0.002341, Recon Loss: 0.002220, LR: 0.001000
Epoch 300/2000, Loss: 0.001977, Recon Loss: 0.001875, LR: 0.001000
Epoch 350/2000, Loss: 0.001855, Recon Loss: 0.001765, LR: 0.001000
Epoch 374: 学习率调整为 0.000500
Epoch 400/2000, Loss: 0.001654, Recon Loss: 0.001578, LR: 0.000500
Epoch 450/2000, Loss: 0.001588, Recon Loss: 0.001506, LR: 0.000500
Epoch 462: 学习率调整为 0.000250
Epoch 500/2000, Loss: 0.001387, Recon Loss: 0.001327, LR: 0.000250
Epoch 539: 学习率调整为 0.000125
Epoch 550/2000, Loss: 0.001416, Recon Loss: 0.001336, LR: 0.000125
Epoch 600/2000, Loss: 0.001306, Recon Loss: 0.001240, LR: 0.000125
Epoch 650/2000, Loss: 0.001314, Recon Loss: 0.001259, LR: 0.000125
Epoch 699: 学习率调整为 0.000063
Epoch 700/2000, Loss: 0.001320, Recon Loss: 0.001259, LR: 0.000063
Epoch 750: 学习率调整为 0.000031
Epoch 750/2000, Loss: 0.001328, Recon Loss: 0.001263, LR: 0.000031
Epoch 800/2000, Loss: 0.001274, Recon Loss: 0.001217, LR: 0.000031
Epoch 835: 学习率调整为 0.000016
Epoch 850/2000, Loss: 0.001311, Recon Loss: 0.001252, LR: 0.000016
Epoch 887: 学习率调整为 0.000008
Epoch 900/2000, Loss: 0.001221, Recon Loss: 0.001162, LR: 0.000008
Epoch 950/2000, Loss: 0.001228, Recon Loss: 0.001170, LR: 0.000008
Epoch 1000/2000, Loss: 0.001298, Recon Loss: 0.001238, LR: 0.000008
Epoch 1050/2000, Loss: 0.001235, Recon Loss: 0.001173, LR: 0.000008
Epoch 1088: 学习率调整为 0.000004
Epoch 1100/2000, Loss: 0.001343, Recon Loss: 0.001281, LR: 0.000004
Epoch 1139: 学习率调整为 0.000002
Epoch 1150/2000, Loss: 0.001310, Recon Loss: 0.001248, LR: 0.000002
Epoch 1190: 学习率调整为 0.000001
Epoch 1200/2000, Loss: 0.001283, Recon Loss: 0.001222, LR: 0.000001
Epoch 1241: 学习率调整为 0.000000
Epoch 1250/2000, Loss: 0.001242, Recon Loss: 0.001186, LR: 0.000000
Epoch 1292: 学习率调整为 0.000000
Epoch 1300/2000, Loss: 0.001323, Recon Loss: 0.001265, LR: 0.000000
Epoch 1343: 学习率调整为 0.000000
Epoch 1350/2000, Loss: 0.001287, Recon Loss: 0.001224, LR: 0.000000
Epoch 1394: 学习率调整为 0.000000
Epoch 1400/2000, Loss: 0.001355, Recon Loss: 0.001291, LR: 0.000000
Epoch 1445: 学习率调整为 0.000000
Epoch 1450/2000, Loss: 0.001233, Recon Loss: 0.001174, LR: 0.000000
Epoch 1496: 学习率调整为 0.000000
Epoch 1500/2000, Loss: 0.001242, Recon Loss: 0.001179, LR: 0.000000
Epoch 1550/2000, Loss: 0.001279, Recon Loss: 0.001211, LR: 0.000000
Epoch 1600/2000, Loss: 0.001274, Recon Loss: 0.001209, LR: 0.000000
Epoch 1650/2000, Loss: 0.001235, Recon Loss: 0.001179, LR: 0.000000
Epoch 1700/2000, Loss: 0.001283, Recon Loss: 0.001223, LR: 0.000000
Epoch 1750/2000, Loss: 0.001268, Recon Loss: 0.001212, LR: 0.000000
Epoch 1800/2000, Loss: 0.001252, Recon Loss: 0.001190, LR: 0.000000
Epoch 1850/2000, Loss: 0.001285, Recon Loss: 0.001223, LR: 0.000000
Epoch 1900/2000, Loss: 0.001278, Recon Loss: 0.001218, LR: 0.000000
Epoch 1950/2000, Loss: 0.001186, Recon Loss: 0.001133, LR: 0.000000
Epoch 2000/2000, Loss: 0.001230, Recon Loss: 0.001178, LR: 0.000000

训练完成，学习率共调整了 16 次
最佳损失: 0.001148
加载最佳模型进行测试...

📈 绘制训练损失曲线...
Loss curves saved to assets/loss_curves_4Lr[True]n12h512ph512E2000.png

============================================================
🧪 开始测试（使用真实数据）...
============================================================
测试数据维度: torch.Size([250, 1024])
压缩后维度: torch.Size([250, 256])
压缩率: 0.250

📊 整体测试结果:
  重建 MAE: 0.120797
  重建 MSE: 0.033103
  PSNR: 14.80 dB

📸 生成可视化对比图（真实数据 vs 重建结果）...
Loss curves saved to assets/Example_4Lr[True]n12h512ph512E2000.png

📈 每张测试图像的详细指标:
  图像 1: PSNR = 18.48 dB, MAE = 0.088221, MSE = 0.014196
  图像 2: PSNR = 18.34 dB, MAE = 0.088445, MSE = 0.014668
  图像 3: PSNR = 17.12 dB, MAE = 0.099468, MSE = 0.019400
  图像 4: PSNR = 20.30 dB, MAE = 0.069137, MSE = 0.009330
  图像 5: PSNR = 16.87 dB, MAE = 0.109051, MSE = 0.020559

============================================================
✅ 测试完成！
  训练数据: 2000 张生成图像
  测试数据: 250 张真实图像
  压缩效果: 1024 维 → 256 维
  最佳模型已保存到: models/best_model.pth
============================================================
