Using device: cuda
============================================================
🎯 训练策略：使用真实数据训练，真实数据测试
============================================================

📂 加载真实数据...
加载了 250 张真实测试图像
测试数据形状: torch.Size([250, 1024])

📊 参数设置:
  输入维度: 1024
  压缩维度: 256
  压缩率: 0.250 (4:1)
  批大小: 32
  训练轮数: 2000
  学习率: 1e-05
  学习率调整: True
  网络层数: 12
  隐藏层维度: 1536
  预测层维度: 1536
检测到旧版本 PyTorch，使用无 verbose 参数的学习率调度器

🚀 开始训练（使用生成数据）...
Epoch 50/2000, Loss: 0.019848, Recon Loss: 0.018442, LR: 1e-05
Epoch 100/2000, Loss: 0.010687, Recon Loss: 0.009932, LR: 1e-05
Epoch 150/2000, Loss: 0.007089, Recon Loss: 0.006605, LR: 1e-05
Epoch 200/2000, Loss: 0.004619, Recon Loss: 0.004149, LR: 1e-05
Epoch 250/2000, Loss: 0.003340, Recon Loss: 0.002949, LR: 1e-05
Epoch 300/2000, Loss: 0.002338, Recon Loss: 0.001995, LR: 1e-05
Epoch 350/2000, Loss: 0.001688, Recon Loss: 0.001374, LR: 1e-05
Epoch 400/2000, Loss: 0.001075, Recon Loss: 0.000789, LR: 1e-05
Epoch 450/2000, Loss: 0.000905, Recon Loss: 0.000651, LR: 1e-05
Epoch 500/2000, Loss: 0.000655, Recon Loss: 0.000412, LR: 1e-05
Epoch 550/2000, Loss: 0.000643, Recon Loss: 0.000431, LR: 1e-05
Epoch 600/2000, Loss: 0.000508, Recon Loss: 0.000325, LR: 1e-05
Epoch 650/2000, Loss: 0.000495, Recon Loss: 0.000334, LR: 1e-05
Epoch 700/2000, Loss: 0.000400, Recon Loss: 0.000226, LR: 1e-05
Epoch 750/2000, Loss: 0.000402, Recon Loss: 0.000237, LR: 1e-05
Epoch 800/2000, Loss: 0.000411, Recon Loss: 0.000249, LR: 1e-05
Epoch 850/2000, Loss: 0.000374, Recon Loss: 0.000247, LR: 1e-05
Epoch 900/2000, Loss: 0.000296, Recon Loss: 0.000161, LR: 1e-05
Epoch 950/2000, Loss: 0.000238, Recon Loss: 0.000117, LR: 1e-05
Epoch 1000: 学习率调整为 0.000005
Epoch 1000/2000, Loss: 0.000300, Recon Loss: 0.000193, LR: 5e-06
Epoch 1050/2000, Loss: 0.000143, Recon Loss: 0.000030, LR: 5e-06
Epoch 1100/2000, Loss: 0.000132, Recon Loss: 0.000027, LR: 5e-06
Epoch 1150/2000, Loss: 0.000114, Recon Loss: 0.000014, LR: 5e-06
Epoch 1200/2000, Loss: 0.000122, Recon Loss: 0.000014, LR: 5e-06
Epoch 1250/2000, Loss: 0.000106, Recon Loss: 0.000014, LR: 5e-06
Epoch 1300/2000, Loss: 0.000100, Recon Loss: 0.000010, LR: 5e-06
Epoch 1350/2000, Loss: 0.000100, Recon Loss: 0.000010, LR: 5e-06
Epoch 1400/2000, Loss: 0.000095, Recon Loss: 0.000010, LR: 5e-06
Epoch 1446: 学习率调整为 0.000003
Epoch 1450/2000, Loss: 0.000083, Recon Loss: 0.000013, LR: 2.5e-06
Epoch 1500/2000, Loss: 0.000083, Recon Loss: 0.000010, LR: 2.5e-06
Epoch 1550/2000, Loss: 0.000083, Recon Loss: 0.000006, LR: 2.5e-06
Epoch 1600/2000, Loss: 0.000084, Recon Loss: 0.000003, LR: 2.5e-06
Epoch 1650/2000, Loss: 0.000087, Recon Loss: 0.000004, LR: 2.5e-06
Epoch 1663: 学习率调整为 0.000001
Epoch 1700/2000, Loss: 0.000078, Recon Loss: 0.000004, LR: 1.25e-06
Epoch 1750/2000, Loss: 0.000076, Recon Loss: 0.000005, LR: 1.25e-06
Epoch 1763: 学习率调整为 0.000001
Epoch 1800/2000, Loss: 0.000078, Recon Loss: 0.000005, LR: 6.25e-07
Epoch 1817: 学习率调整为 0.000000
Epoch 1850/2000, Loss: 0.000075, Recon Loss: 0.000004, LR: 3.125e-07
Epoch 1868: 学习率调整为 0.000000
Epoch 1900/2000, Loss: 0.000075, Recon Loss: 0.000004, LR: 1.5625e-07
Epoch 1949: 学习率调整为 0.000000
Epoch 1950/2000, Loss: 0.000072, Recon Loss: 0.000004, LR: 7.8125e-08
Epoch 2000: 学习率调整为 0.000000
Epoch 2000/2000, Loss: 0.000070, Recon Loss: 0.000005, LR: 3.90625e-08

训练完成，学习率共调整了 8 次
最佳损失: 0.000066
加载最佳模型进行测试...

📈 绘制训练损失曲线...
Loss curves saved to assets/loss_curves_res_4Lr[True]n12h1536ph1536E2000.png

============================================================
🧪 开始测试（使用真实数据）...
============================================================
测试数据维度: torch.Size([250, 1024])
压缩后维度: torch.Size([250, 256])
压缩率: 0.250

📊 整体测试结果:
  重建 MAE: 0.001349
  重建 MSE: 0.000004
  PSNR: 53.65 dB

📸 生成可视化对比图（真实数据 vs 重建结果）...
Loss curves saved to assets/Res_4Lr[True]n12h1536ph1536E2000.png

📈 每张测试图像的详细指标:
  图像 1: PSNR = 57.12 dB, MAE = 0.001034, MSE = 0.000002
  图像 2: PSNR = 55.10 dB, MAE = 0.001262, MSE = 0.000003
  图像 3: PSNR = 60.25 dB, MAE = 0.000723, MSE = 0.000001
  图像 4: PSNR = 55.66 dB, MAE = 0.001232, MSE = 0.000003
  图像 5: PSNR = 56.56 dB, MAE = 0.001115, MSE = 0.000002

============================================================
✅ 测试完成！
  训练数据: 250 张生成图像
  测试数据: 250 张真实图像
  压缩效果: 1024 维 → 256 维
  最佳模型已保存到: models/best_model.pth
============================================================
