Using device: cuda
============================================================
🎯 训练策略：使用生成数据训练，真实数据测试
============================================================

🔧 生成训练数据...
生成了 2000 张训练图像
训练数据形状: torch.Size([2000, 1024])

📂 加载真实测试数据...
加载了 250 张真实测试图像
测试数据形状: torch.Size([250, 1024])

📊 参数设置:
  输入维度: 1024
  压缩维度: 256
  压缩率: 0.250 (4:1)
  批大小: 32
  训练轮数: 2000
  学习率: 1e-05
  学习率调整: True
  网络层数: 12
  隐藏层维度: 1024
  预测层维度: 1024
检测到旧版本 PyTorch，使用无 verbose 参数的学习率调度器

🚀 开始训练（使用生成数据）...
Epoch 50/2000, Loss: 0.010013, Recon Loss: 0.009769, LR: 0.000010
Epoch 100/2000, Loss: 0.005292, Recon Loss: 0.005001, LR: 0.000010
Epoch 150/2000, Loss: 0.004073, Recon Loss: 0.003782, LR: 0.000010
Epoch 200/2000, Loss: 0.003734, Recon Loss: 0.003497, LR: 0.000010
Epoch 250/2000, Loss: 0.002903, Recon Loss: 0.002725, LR: 0.000010
Epoch 300/2000, Loss: 0.002837, Recon Loss: 0.002665, LR: 0.000010
Epoch 350/2000, Loss: 0.002529, Recon Loss: 0.002386, LR: 0.000010
Epoch 400/2000, Loss: 0.002297, Recon Loss: 0.002170, LR: 0.000010
Epoch 450/2000, Loss: 0.002064, Recon Loss: 0.001951, LR: 0.000010
Epoch 500/2000, Loss: 0.002081, Recon Loss: 0.001971, LR: 0.000010
Epoch 550/2000, Loss: 0.002008, Recon Loss: 0.001917, LR: 0.000010
Epoch 584: 学习率调整为 0.000005
Epoch 600/2000, Loss: 0.001960, Recon Loss: 0.001866, LR: 0.000005
Epoch 650/2000, Loss: 0.001996, Recon Loss: 0.001904, LR: 0.000005
Epoch 700/2000, Loss: 0.001851, Recon Loss: 0.001767, LR: 0.000005
Epoch 703: 学习率调整为 0.000003
Epoch 750/2000, Loss: 0.001742, Recon Loss: 0.001665, LR: 0.000003
Epoch 800/2000, Loss: 0.001731, Recon Loss: 0.001646, LR: 0.000003
Epoch 833: 学习率调整为 0.000001
Epoch 850/2000, Loss: 0.001884, Recon Loss: 0.001796, LR: 0.000001
Epoch 900: 学习率调整为 0.000001
Epoch 900/2000, Loss: 0.001810, Recon Loss: 0.001719, LR: 0.000001
Epoch 950/2000, Loss: 0.001661, Recon Loss: 0.001596, LR: 0.000001
Epoch 1000/2000, Loss: 0.001911, Recon Loss: 0.001814, LR: 0.000001
Epoch 1008: 学习率调整为 0.000000
Epoch 1050/2000, Loss: 0.001714, Recon Loss: 0.001638, LR: 0.000000
Epoch 1059: 学习率调整为 0.000000
Epoch 1100/2000, Loss: 0.001785, Recon Loss: 0.001699, LR: 0.000000
Epoch 1116: 学习率调整为 0.000000
Epoch 1150/2000, Loss: 0.001725, Recon Loss: 0.001646, LR: 0.000000
Epoch 1167: 学习率调整为 0.000000
Epoch 1200/2000, Loss: 0.001645, Recon Loss: 0.001578, LR: 0.000000
Epoch 1218: 学习率调整为 0.000000
Epoch 1250/2000, Loss: 0.001692, Recon Loss: 0.001613, LR: 0.000000
Epoch 1300/2000, Loss: 0.001747, Recon Loss: 0.001663, LR: 0.000000
Epoch 1350/2000, Loss: 0.001679, Recon Loss: 0.001596, LR: 0.000000
Epoch 1400/2000, Loss: 0.001731, Recon Loss: 0.001657, LR: 0.000000
Epoch 1450/2000, Loss: 0.001771, Recon Loss: 0.001687, LR: 0.000000
Epoch 1500/2000, Loss: 0.001707, Recon Loss: 0.001629, LR: 0.000000
Epoch 1550/2000, Loss: 0.001759, Recon Loss: 0.001686, LR: 0.000000
Epoch 1600/2000, Loss: 0.001674, Recon Loss: 0.001606, LR: 0.000000
Epoch 1650/2000, Loss: 0.001674, Recon Loss: 0.001605, LR: 0.000000
Epoch 1700/2000, Loss: 0.001593, Recon Loss: 0.001516, LR: 0.000000
Epoch 1750/2000, Loss: 0.001779, Recon Loss: 0.001680, LR: 0.000000
Epoch 1800/2000, Loss: 0.001718, Recon Loss: 0.001628, LR: 0.000000
Epoch 1850/2000, Loss: 0.001738, Recon Loss: 0.001653, LR: 0.000000
Epoch 1900/2000, Loss: 0.001656, Recon Loss: 0.001570, LR: 0.000000
Epoch 1950/2000, Loss: 0.001810, Recon Loss: 0.001733, LR: 0.000000
Epoch 2000/2000, Loss: 0.001672, Recon Loss: 0.001596, LR: 0.000000

训练完成，学习率共调整了 9 次
最佳损失: 0.001551
加载最佳模型进行测试...

📈 绘制训练损失曲线...
Loss curves saved to assets/loss_curves_4Lr[True]n12h1024ph1024E2000.png

============================================================
🧪 开始测试（使用真实数据）...
============================================================
测试数据维度: torch.Size([250, 1024])
压缩后维度: torch.Size([250, 256])
压缩率: 0.250

📊 整体测试结果:
  重建 MAE: 0.147583
  重建 MSE: 0.046527
  PSNR: 13.32 dB

📸 生成可视化对比图（真实数据 vs 重建结果）...
Loss curves saved to assets/Example_4Lr[True]n12h1024ph1024E2000.png

📈 每张测试图像的详细指标:
  图像 1: PSNR = 16.88 dB, MAE = 0.107469, MSE = 0.020516
  图像 2: PSNR = 16.44 dB, MAE = 0.109670, MSE = 0.022685
  图像 3: PSNR = 14.80 dB, MAE = 0.130370, MSE = 0.033111
  图像 4: PSNR = 19.66 dB, MAE = 0.078090, MSE = 0.010817
  图像 5: PSNR = 15.23 dB, MAE = 0.131672, MSE = 0.030017

============================================================
✅ 测试完成！
  训练数据: 2000 张生成图像
  测试数据: 250 张真实图像
  压缩效果: 1024 维 → 256 维
  最佳模型已保存到: models/best_model.pth
============================================================
