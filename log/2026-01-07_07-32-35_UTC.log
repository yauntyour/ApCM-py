Using device: cuda
============================================================
🎯 训练策略：使用真实数据训练，真实数据测试
============================================================

📂 加载真实数据...
加载了 250 张真实测试图像
测试数据形状: torch.Size([250, 1024])

📊 参数设置:
  输入维度: 1024
  压缩维度: 128
  压缩率: 0.125 (8:1)
  批大小: 32
  训练轮数: 2000
  学习率: 0.001
  学习率调整: True
  网络层数: 6
  隐藏层维度: 256
  预测层维度: 256
检测到旧版本 PyTorch，使用无 verbose 参数的学习率调度器

🚀 开始训练（使用生成数据）...
Epoch 50/2000, Loss: 0.021375, Recon Loss: 0.020762, LR: 0.001
Epoch 100/2000, Loss: 0.016570, Recon Loss: 0.016043, LR: 0.001
Epoch 150/2000, Loss: 0.012379, Recon Loss: 0.011919, LR: 0.001
Epoch 200/2000, Loss: 0.008521, Recon Loss: 0.008115, LR: 0.001
Epoch 250/2000, Loss: 0.007735, Recon Loss: 0.007284, LR: 0.001
Epoch 300/2000, Loss: 0.005465, Recon Loss: 0.005127, LR: 0.001
Epoch 350/2000, Loss: 0.004809, Recon Loss: 0.004432, LR: 0.001
Epoch 400/2000, Loss: 0.004188, Recon Loss: 0.003870, LR: 0.001
Epoch 450/2000, Loss: 0.003487, Recon Loss: 0.003165, LR: 0.001
Epoch 500/2000, Loss: 0.002962, Recon Loss: 0.002654, LR: 0.001
Epoch 550/2000, Loss: 0.002093, Recon Loss: 0.001801, LR: 0.001
Epoch 600/2000, Loss: 0.002035, Recon Loss: 0.001792, LR: 0.001
Epoch 607: 学习率调整为 0.000500
Epoch 650/2000, Loss: 0.001037, Recon Loss: 0.000785, LR: 0.0005
Epoch 700/2000, Loss: 0.000806, Recon Loss: 0.000588, LR: 0.0005
Epoch 750/2000, Loss: 0.000719, Recon Loss: 0.000502, LR: 0.0005
Epoch 800/2000, Loss: 0.000556, Recon Loss: 0.000338, LR: 0.0005
Epoch 850/2000, Loss: 0.000580, Recon Loss: 0.000406, LR: 0.0005
Epoch 900/2000, Loss: 0.000476, Recon Loss: 0.000303, LR: 0.0005
Epoch 950/2000, Loss: 0.000542, Recon Loss: 0.000370, LR: 0.0005
Epoch 981: 学习率调整为 0.000250
Epoch 1000/2000, Loss: 0.000487, Recon Loss: 0.000306, LR: 0.00025
Epoch 1050/2000, Loss: 0.000369, Recon Loss: 0.000195, LR: 0.00025
Epoch 1100/2000, Loss: 0.000319, Recon Loss: 0.000166, LR: 0.00025
Epoch 1150/2000, Loss: 0.000311, Recon Loss: 0.000144, LR: 0.00025
Epoch 1200/2000, Loss: 0.000276, Recon Loss: 0.000119, LR: 0.00025
Epoch 1250/2000, Loss: 0.000303, Recon Loss: 0.000144, LR: 0.00025
Epoch 1300/2000, Loss: 0.000258, Recon Loss: 0.000111, LR: 0.00025
Epoch 1345: 学习率调整为 0.000125
Epoch 1350/2000, Loss: 0.000268, Recon Loss: 0.000105, LR: 0.000125
Epoch 1400/2000, Loss: 0.000241, Recon Loss: 0.000104, LR: 0.000125
Epoch 1445: 学习率调整为 0.000063
Epoch 1450/2000, Loss: 0.000232, Recon Loss: 0.000101, LR: 6.25e-05
Epoch 1496: 学习率调整为 0.000031
Epoch 1500/2000, Loss: 0.000225, Recon Loss: 0.000082, LR: 3.125e-05
Epoch 1550/2000, Loss: 0.000233, Recon Loss: 0.000096, LR: 3.125e-05
Epoch 1585: 学习率调整为 0.000016
Epoch 1600/2000, Loss: 0.000248, Recon Loss: 0.000111, LR: 1.5625e-05
Epoch 1636: 学习率调整为 0.000008
Epoch 1650/2000, Loss: 0.000227, Recon Loss: 0.000091, LR: 7.8125e-06
Epoch 1700/2000, Loss: 0.000234, Recon Loss: 0.000088, LR: 7.8125e-06
Epoch 1711: 学习率调整为 0.000004
Epoch 1750/2000, Loss: 0.000248, Recon Loss: 0.000096, LR: 3.90625e-06
Epoch 1762: 学习率调整为 0.000002
Epoch 1800/2000, Loss: 0.000243, Recon Loss: 0.000115, LR: 1.953125e-06
Epoch 1850/2000, Loss: 0.000224, Recon Loss: 0.000093, LR: 1.953125e-06
Epoch 1859: 学习率调整为 0.000001
Epoch 1900/2000, Loss: 0.000209, Recon Loss: 0.000085, LR: 9.765625e-07
Epoch 1910: 学习率调整为 0.000000
Epoch 1950/2000, Loss: 0.000238, Recon Loss: 0.000097, LR: 4.8828125e-07
Epoch 1986: 学习率调整为 0.000000
Epoch 2000/2000, Loss: 0.000230, Recon Loss: 0.000091, LR: 2.44140625e-07

训练完成，学习率共调整了 12 次
最佳损失: 0.000203
加载最佳模型进行测试...

📈 绘制训练损失曲线...
Loss curves saved to assets/loss_curves_res_8Lr[True]n6h256ph256E2000.png

============================================================
🧪 开始测试（使用真实数据）...
============================================================
测试数据维度: torch.Size([250, 1024])
压缩后维度: torch.Size([250, 128])
压缩率: 0.125

📊 整体测试结果:
  重建 MAE: 0.004797
  重建 MSE: 0.000089
  PSNR: 40.51 dB

📸 生成可视化对比图（真实数据 vs 重建结果）...
Loss curves saved to assets/Res_8Lr[True]n6h256ph256E2000.png

📈 每张测试图像的详细指标:
  图像 1: PSNR = 40.60 dB, MAE = 0.004741, MSE = 0.000087
  图像 2: PSNR = 39.04 dB, MAE = 0.005617, MSE = 0.000125
  图像 3: PSNR = 44.34 dB, MAE = 0.002972, MSE = 0.000037
  图像 4: PSNR = 42.05 dB, MAE = 0.004154, MSE = 0.000062
  图像 5: PSNR = 43.14 dB, MAE = 0.003336, MSE = 0.000049

============================================================
✅ 测试完成！
  训练数据: 250 张生成图像
  测试数据: 250 张真实图像
  压缩效果: 1024 维 → 128 维
  最佳模型已保存到: models/best_model.pth
============================================================
