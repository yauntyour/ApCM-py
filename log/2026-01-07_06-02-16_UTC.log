Using device: cuda
============================================================
🎯 训练策略：使用生成数据训练，真实数据测试
============================================================

📂 加载真实数据...
加载了 250 张真实测试图像
测试数据形状: torch.Size([250, 1024])

📊 参数设置:
  输入维度: 1024
  压缩维度: 256
  压缩率: 0.250 (4:1)
  批大小: 32
  训练轮数: 2000
  学习率: 1e-05
  学习率调整: True
  网络层数: 6
  隐藏层维度: 1536
  预测层维度: 1536
检测到旧版本 PyTorch，使用无 verbose 参数的学习率调度器

🚀 开始训练（使用生成数据）...
Epoch 50/2000, Loss: 0.159621, Recon Loss: 0.158148, LR: 1e-05
Epoch 100/2000, Loss: 0.048369, Recon Loss: 0.046890, LR: 1e-05
Epoch 150/2000, Loss: 0.039883, Recon Loss: 0.038206, LR: 1e-05
Epoch 200/2000, Loss: 0.031147, Recon Loss: 0.029759, LR: 1e-05
Epoch 250/2000, Loss: 0.025284, Recon Loss: 0.024059, LR: 1e-05
Epoch 287: 学习率调整为 0.000005
Epoch 300/2000, Loss: 0.024836, Recon Loss: 0.023575, LR: 5e-06
Epoch 350/2000, Loss: 0.023613, Recon Loss: 0.022480, LR: 5e-06
Epoch 380: 学习率调整为 0.000003
Epoch 400/2000, Loss: 0.023720, Recon Loss: 0.022534, LR: 2.5e-06
Epoch 450/2000, Loss: 0.023897, Recon Loss: 0.022645, LR: 2.5e-06
Epoch 500/2000, Loss: 0.019935, Recon Loss: 0.018707, LR: 2.5e-06
Epoch 550/2000, Loss: 0.024243, Recon Loss: 0.023001, LR: 2.5e-06
Epoch 600/2000, Loss: 0.022731, Recon Loss: 0.021537, LR: 2.5e-06
Epoch 637: 学习率调整为 0.000001
Epoch 650/2000, Loss: 0.023527, Recon Loss: 0.022354, LR: 1.25e-06
Epoch 688: 学习率调整为 0.000001
Epoch 700/2000, Loss: 0.019567, Recon Loss: 0.018169, LR: 6.25e-07
Epoch 750/2000, Loss: 0.025249, Recon Loss: 0.023926, LR: 6.25e-07
Epoch 800/2000, Loss: 0.019516, Recon Loss: 0.018339, LR: 6.25e-07
Epoch 850/2000, Loss: 0.020817, Recon Loss: 0.019799, LR: 6.25e-07
Epoch 860: 学习率调整为 0.000000
Epoch 900/2000, Loss: 0.024250, Recon Loss: 0.023025, LR: 3.125e-07
Epoch 911: 学习率调整为 0.000000
Epoch 950/2000, Loss: 0.018897, Recon Loss: 0.017753, LR: 1.5625e-07
Epoch 962: 学习率调整为 0.000000
Epoch 1000/2000, Loss: 0.021247, Recon Loss: 0.020081, LR: 7.8125e-08
Epoch 1013: 学习率调整为 0.000000
Epoch 1050/2000, Loss: 0.020535, Recon Loss: 0.019357, LR: 3.90625e-08
Epoch 1064: 学习率调整为 0.000000
Epoch 1100/2000, Loss: 0.022628, Recon Loss: 0.021438, LR: 1.953125e-08
Epoch 1150/2000, Loss: 0.022307, Recon Loss: 0.021046, LR: 1.953125e-08
Epoch 1200/2000, Loss: 0.024374, Recon Loss: 0.023129, LR: 1.953125e-08
Epoch 1250/2000, Loss: 0.020962, Recon Loss: 0.019783, LR: 1.953125e-08
Epoch 1300/2000, Loss: 0.023572, Recon Loss: 0.022373, LR: 1.953125e-08
Epoch 1350/2000, Loss: 0.023677, Recon Loss: 0.022557, LR: 1.953125e-08
Epoch 1400/2000, Loss: 0.020317, Recon Loss: 0.019127, LR: 1.953125e-08
Epoch 1450/2000, Loss: 0.021310, Recon Loss: 0.020037, LR: 1.953125e-08
Epoch 1500/2000, Loss: 0.020066, Recon Loss: 0.018813, LR: 1.953125e-08
Epoch 1550/2000, Loss: 0.020274, Recon Loss: 0.019126, LR: 1.953125e-08
Epoch 1600/2000, Loss: 0.021135, Recon Loss: 0.019908, LR: 1.953125e-08
Epoch 1650/2000, Loss: 0.019853, Recon Loss: 0.018618, LR: 1.953125e-08
Epoch 1700/2000, Loss: 0.021696, Recon Loss: 0.020261, LR: 1.953125e-08
Epoch 1750/2000, Loss: 0.022196, Recon Loss: 0.020940, LR: 1.953125e-08
Epoch 1800/2000, Loss: 0.024823, Recon Loss: 0.023480, LR: 1.953125e-08
Epoch 1850/2000, Loss: 0.025696, Recon Loss: 0.024462, LR: 1.953125e-08
Epoch 1900/2000, Loss: 0.024184, Recon Loss: 0.022944, LR: 1.953125e-08
Epoch 1950/2000, Loss: 0.019776, Recon Loss: 0.018584, LR: 1.953125e-08
Epoch 2000/2000, Loss: 0.018455, Recon Loss: 0.017152, LR: 1.953125e-08

训练完成，学习率共调整了 9 次
最佳损失: 0.017151
加载最佳模型进行测试...

📈 绘制训练损失曲线...
Loss curves saved to assets/loss_curves_4Lr[True]n6h1536ph1536E2000.png

============================================================
🧪 开始测试（使用真实数据）...
============================================================
测试数据维度: torch.Size([250, 1024])
压缩后维度: torch.Size([250, 256])
压缩率: 0.250

📊 整体测试结果:
  重建 MAE: 0.095701
  重建 MSE: 0.020994
  PSNR: 16.78 dB

📸 生成可视化对比图（真实数据 vs 重建结果）...
Loss curves saved to assets/Example_4Lr[True]n6h1536ph1536E2000.png

📈 每张测试图像的详细指标:
  图像 1: PSNR = 16.40 dB, MAE = 0.099966, MSE = 0.022887
  图像 2: PSNR = 17.78 dB, MAE = 0.084906, MSE = 0.016669
  图像 3: PSNR = 14.22 dB, MAE = 0.127790, MSE = 0.037875
  图像 4: PSNR = 19.01 dB, MAE = 0.075735, MSE = 0.012561
  图像 5: PSNR = 15.95 dB, MAE = 0.106442, MSE = 0.025404

============================================================
✅ 测试完成！
  训练数据: 250 张生成图像
  测试数据: 250 张真实图像
  压缩效果: 1024 维 → 256 维
  最佳模型已保存到: models/best_model.pth
============================================================
