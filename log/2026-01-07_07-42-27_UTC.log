Using device: cuda
============================================================
🎯 训练策略：使用生成数据训练，真实数据测试
============================================================

🔧 生成训练数据...
生成了 2000 张训练图像
训练数据形状: torch.Size([2000, 1024])

📂 加载真实测试数据...
加载了 250 张真实测试图像
测试数据形状: torch.Size([250, 1024])

📊 参数设置:
  输入维度: 1024
  压缩维度: 128
  压缩率: 0.125 (8:1)
  批大小: 32
  训练轮数: 2000
  学习率: 1e-05
  学习率调整: True
  网络层数: 12
  隐藏层维度: 512
  预测层维度: 512
检测到旧版本 PyTorch，使用无 verbose 参数的学习率调度器

🚀 开始训练（使用生成数据）...
Epoch 50/2000, Loss: 0.023289, Recon Loss: 0.022895, LR: 0.000010
Epoch 100/2000, Loss: 0.017255, Recon Loss: 0.016757, LR: 0.000010
Epoch 150/2000, Loss: 0.010881, Recon Loss: 0.010458, LR: 0.000010
Epoch 200/2000, Loss: 0.006816, Recon Loss: 0.006502, LR: 0.000010
Epoch 250/2000, Loss: 0.006298, Recon Loss: 0.005997, LR: 0.000010
Epoch 300/2000, Loss: 0.004972, Recon Loss: 0.004727, LR: 0.000010
Epoch 350/2000, Loss: 0.005137, Recon Loss: 0.004923, LR: 0.000010
Epoch 400/2000, Loss: 0.005282, Recon Loss: 0.005042, LR: 0.000010
Epoch 450/2000, Loss: 0.004448, Recon Loss: 0.004261, LR: 0.000010
Epoch 486: 学习率调整为 0.000005
Epoch 500/2000, Loss: 0.004015, Recon Loss: 0.003839, LR: 0.000005
Epoch 550/2000, Loss: 0.004156, Recon Loss: 0.003983, LR: 0.000005
Epoch 568: 学习率调整为 0.000003
Epoch 600/2000, Loss: 0.003885, Recon Loss: 0.003714, LR: 0.000003
Epoch 619: 学习率调整为 0.000001
Epoch 650/2000, Loss: 0.003524, Recon Loss: 0.003372, LR: 0.000001
Epoch 675: 学习率调整为 0.000001
Epoch 700/2000, Loss: 0.003496, Recon Loss: 0.003358, LR: 0.000001
Epoch 726: 学习率调整为 0.000000
Epoch 750/2000, Loss: 0.003813, Recon Loss: 0.003671, LR: 0.000000
Epoch 800/2000, Loss: 0.003542, Recon Loss: 0.003391, LR: 0.000000
Epoch 850/2000, Loss: 0.003304, Recon Loss: 0.003166, LR: 0.000000
Epoch 872: 学习率调整为 0.000000
Epoch 900/2000, Loss: 0.003767, Recon Loss: 0.003591, LR: 0.000000
Epoch 923: 学习率调整为 0.000000
Epoch 950/2000, Loss: 0.003723, Recon Loss: 0.003571, LR: 0.000000
Epoch 1000/2000, Loss: 0.003669, Recon Loss: 0.003530, LR: 0.000000
Epoch 1010: 学习率调整为 0.000000
Epoch 1050/2000, Loss: 0.003493, Recon Loss: 0.003340, LR: 0.000000
Epoch 1061: 学习率调整为 0.000000
Epoch 1100/2000, Loss: 0.003256, Recon Loss: 0.003118, LR: 0.000000
Epoch 1150/2000, Loss: 0.003858, Recon Loss: 0.003687, LR: 0.000000
Epoch 1200/2000, Loss: 0.003202, Recon Loss: 0.003063, LR: 0.000000
Epoch 1250/2000, Loss: 0.003563, Recon Loss: 0.003440, LR: 0.000000
Epoch 1300/2000, Loss: 0.003383, Recon Loss: 0.003250, LR: 0.000000
Epoch 1350/2000, Loss: 0.003952, Recon Loss: 0.003794, LR: 0.000000
Epoch 1400/2000, Loss: 0.003672, Recon Loss: 0.003521, LR: 0.000000
Epoch 1450/2000, Loss: 0.003257, Recon Loss: 0.003138, LR: 0.000000
Epoch 1500/2000, Loss: 0.003979, Recon Loss: 0.003807, LR: 0.000000
Epoch 1550/2000, Loss: 0.003408, Recon Loss: 0.003271, LR: 0.000000
Epoch 1600/2000, Loss: 0.003702, Recon Loss: 0.003544, LR: 0.000000
Epoch 1650/2000, Loss: 0.003500, Recon Loss: 0.003365, LR: 0.000000
Epoch 1700/2000, Loss: 0.003504, Recon Loss: 0.003361, LR: 0.000000
Epoch 1750/2000, Loss: 0.003633, Recon Loss: 0.003495, LR: 0.000000
Epoch 1800/2000, Loss: 0.003667, Recon Loss: 0.003497, LR: 0.000000
Epoch 1850/2000, Loss: 0.003596, Recon Loss: 0.003446, LR: 0.000000
Epoch 1900/2000, Loss: 0.003665, Recon Loss: 0.003503, LR: 0.000000
Epoch 1950/2000, Loss: 0.003121, Recon Loss: 0.003009, LR: 0.000000
Epoch 2000/2000, Loss: 0.003679, Recon Loss: 0.003536, LR: 0.000000

训练完成，学习率共调整了 9 次
最佳损失: 0.002884
加载最佳模型进行测试...

📈 绘制训练损失曲线...
Loss curves saved to assets/loss_curves_res_GR8Lr[True]n12h512ph512E2000.png

============================================================
🧪 开始测试（使用真实数据）...
============================================================
测试数据维度: torch.Size([250, 1024])
压缩后维度: torch.Size([250, 128])
压缩率: 0.125

📊 整体测试结果:
  重建 MAE: 0.178841
  重建 MSE: 0.063851
  PSNR: 11.95 dB

📸 生成可视化对比图（真实数据 vs 重建结果）...
Loss curves saved to assets/Example_res_GR_8Lr[True]n12h512ph512E2000.png

📈 每张测试图像的详细指标:
  图像 1: PSNR = 14.79 dB, MAE = 0.137730, MSE = 0.033157
  图像 2: PSNR = 14.87 dB, MAE = 0.134148, MSE = 0.032567
  图像 3: PSNR = 13.10 dB, MAE = 0.161362, MSE = 0.048925
  图像 4: PSNR = 17.62 dB, MAE = 0.100680, MSE = 0.017311
  图像 5: PSNR = 13.39 dB, MAE = 0.165636, MSE = 0.045797

============================================================
✅ 测试完成！
  训练数据: 2000 张生成图像
  测试数据: 250 张真实图像
  压缩效果: 1024 维 → 128 维
  最佳模型已保存到: models/best_model.pth
============================================================
