Using device: cuda
============================================================
🎯 训练策略：使用生成数据训练，真实数据测试
============================================================

🔧 生成训练数据...
生成了 2000 张训练图像
训练数据形状: torch.Size([2000, 1024])

📂 加载真实测试数据...
加载了 250 张真实测试图像
测试数据形状: torch.Size([250, 1024])

📊 参数设置:
  输入维度: 1024
  压缩维度: 128
  压缩率: 0.125 (8:1)
  批大小: 32
  训练轮数: 2000
  学习率: 0.001
  学习率调整: True
  网络层数: 6
  隐藏层维度: 768
  预测层维度: 768
检测到旧版本 PyTorch，使用无 verbose 参数的学习率调度器

🚀 开始训练（使用生成数据）...
Epoch 50/2000, Loss: 0.007718, Recon Loss: 0.007427, LR: 0.001000
Epoch 100/2000, Loss: 0.003916, Recon Loss: 0.003641, LR: 0.001000
Epoch 150/2000, Loss: 0.004041, Recon Loss: 0.003804, LR: 0.001000
Epoch 200/2000, Loss: 0.003649, Recon Loss: 0.003432, LR: 0.001000
Epoch 209: 学习率调整为 0.000500
Epoch 250/2000, Loss: 0.003005, Recon Loss: 0.002804, LR: 0.000500
Epoch 300/2000, Loss: 0.002984, Recon Loss: 0.002791, LR: 0.000500
Epoch 350/2000, Loss: 0.002805, Recon Loss: 0.002647, LR: 0.000500
Epoch 400/2000, Loss: 0.002576, Recon Loss: 0.002411, LR: 0.000500
Epoch 438: 学习率调整为 0.000250
Epoch 450/2000, Loss: 0.002585, Recon Loss: 0.002437, LR: 0.000250
Epoch 500/2000, Loss: 0.002403, Recon Loss: 0.002267, LR: 0.000250
Epoch 550/2000, Loss: 0.002365, Recon Loss: 0.002235, LR: 0.000250
Epoch 600/2000, Loss: 0.002296, Recon Loss: 0.002174, LR: 0.000250
Epoch 633: 学习率调整为 0.000125
Epoch 650/2000, Loss: 0.002305, Recon Loss: 0.002173, LR: 0.000125
Epoch 700/2000, Loss: 0.002314, Recon Loss: 0.002193, LR: 0.000125
Epoch 734: 学习率调整为 0.000063
Epoch 750/2000, Loss: 0.002026, Recon Loss: 0.001920, LR: 0.000063
Epoch 800/2000, Loss: 0.002240, Recon Loss: 0.002120, LR: 0.000063
Epoch 850/2000, Loss: 0.002153, Recon Loss: 0.002049, LR: 0.000063
Epoch 859: 学习率调整为 0.000031
Epoch 900/2000, Loss: 0.002038, Recon Loss: 0.001912, LR: 0.000031
Epoch 950/2000, Loss: 0.002195, Recon Loss: 0.002077, LR: 0.000031
Epoch 954: 学习率调整为 0.000016
Epoch 1000/2000, Loss: 0.002075, Recon Loss: 0.001969, LR: 0.000016
Epoch 1039: 学习率调整为 0.000008
Epoch 1050/2000, Loss: 0.002053, Recon Loss: 0.001941, LR: 0.000008
Epoch 1100/2000, Loss: 0.002144, Recon Loss: 0.002021, LR: 0.000008
Epoch 1129: 学习率调整为 0.000004
Epoch 1150/2000, Loss: 0.001988, Recon Loss: 0.001875, LR: 0.000004
Epoch 1180: 学习率调整为 0.000002
Epoch 1200/2000, Loss: 0.002041, Recon Loss: 0.001924, LR: 0.000002
Epoch 1231: 学习率调整为 0.000001
Epoch 1250/2000, Loss: 0.002049, Recon Loss: 0.001931, LR: 0.000001
Epoch 1292: 学习率调整为 0.000000
Epoch 1300/2000, Loss: 0.002119, Recon Loss: 0.002006, LR: 0.000000
Epoch 1343: 学习率调整为 0.000000
Epoch 1350/2000, Loss: 0.002037, Recon Loss: 0.001920, LR: 0.000000
Epoch 1394: 学习率调整为 0.000000
Epoch 1400/2000, Loss: 0.002035, Recon Loss: 0.001894, LR: 0.000000
Epoch 1445: 学习率调整为 0.000000
Epoch 1450/2000, Loss: 0.002073, Recon Loss: 0.001944, LR: 0.000000
Epoch 1496: 学习率调整为 0.000000
Epoch 1500/2000, Loss: 0.002133, Recon Loss: 0.002007, LR: 0.000000
Epoch 1550/2000, Loss: 0.002011, Recon Loss: 0.001901, LR: 0.000000
Epoch 1564: 学习率调整为 0.000000
Epoch 1600/2000, Loss: 0.002153, Recon Loss: 0.002033, LR: 0.000000
Epoch 1650/2000, Loss: 0.002027, Recon Loss: 0.001909, LR: 0.000000
Epoch 1700/2000, Loss: 0.002093, Recon Loss: 0.001976, LR: 0.000000
Epoch 1750/2000, Loss: 0.002058, Recon Loss: 0.001942, LR: 0.000000
Epoch 1800/2000, Loss: 0.002212, Recon Loss: 0.002106, LR: 0.000000
Epoch 1850/2000, Loss: 0.002037, Recon Loss: 0.001927, LR: 0.000000
Epoch 1900/2000, Loss: 0.001951, Recon Loss: 0.001817, LR: 0.000000
Epoch 1950/2000, Loss: 0.002004, Recon Loss: 0.001870, LR: 0.000000
Epoch 2000/2000, Loss: 0.002041, Recon Loss: 0.001922, LR: 0.000000

训练完成，学习率共调整了 16 次
最佳损失: 0.001851
加载最佳模型进行测试...

📈 绘制训练损失曲线...
Loss curves saved to assets/loss_curves_8Lr[True]n6h768ph768E2000.png

============================================================
🧪 开始测试（使用真实数据）...
============================================================
测试数据维度: torch.Size([250, 1024])
压缩后维度: torch.Size([250, 128])
压缩率: 0.125

📊 整体测试结果:
  重建 MAE: nan
  重建 MSE: nan
  PSNR: nan dB

📸 生成可视化对比图（真实数据 vs 重建结果）...
Loss curves saved to assets/Example_8Lr[True]n6h768ph768E2000.png

📈 每张测试图像的详细指标:
  图像 1: PSNR = 12.91 dB, MAE = 0.184877, MSE = 0.051138
  图像 2: PSNR = 15.96 dB, MAE = 0.129172, MSE = 0.025343
  图像 3: PSNR = 8.82 dB, MAE = 0.280956, MSE = 0.131083
  图像 4: PSNR = 19.05 dB, MAE = 0.082789, MSE = 0.012457
  图像 5: PSNR = 12.15 dB, MAE = 0.196370, MSE = 0.061022

============================================================
✅ 测试完成！
  训练数据: 2000 张生成图像
  测试数据: 250 张真实图像
  压缩效果: 1024 维 → 128 维
  最佳模型已保存到: models/best_model.pth
============================================================
