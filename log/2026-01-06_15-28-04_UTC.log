Using device: cuda
============================================================
🎯 训练策略：使用生成数据训练，真实数据测试
============================================================

🔧 生成训练数据...
生成了 2000 张训练图像
训练数据形状: torch.Size([2000, 1024])

📂 加载真实测试数据...
加载了 250 张真实测试图像
测试数据形状: torch.Size([250, 1024])

📊 参数设置:
  输入维度: 1024
  压缩维度: 256
  压缩率: 0.250 (4:1)
  批大小: 32
  训练轮数: 2000
  学习率: 0.001
  学习率调整: True
  网络层数: 6
  隐藏层维度: 1024
  预测层维度: 1024
检测到旧版本 PyTorch，使用无 verbose 参数的学习率调度器

🚀 开始训练（使用生成数据）...
Epoch 50/2000, Loss: 0.007793, Recon Loss: 0.007570, LR: 0.001000
Epoch 100/2000, Loss: 0.003877, Recon Loss: 0.003655, LR: 0.001000
Epoch 150/2000, Loss: 0.003203, Recon Loss: 0.003012, LR: 0.001000
Epoch 200/2000, Loss: 0.002740, Recon Loss: 0.002535, LR: 0.001000
Epoch 250/2000, Loss: 0.002418, Recon Loss: 0.002255, LR: 0.001000
Epoch 300/2000, Loss: 0.002217, Recon Loss: 0.002068, LR: 0.001000
Epoch 350/2000, Loss: 0.002205, Recon Loss: 0.002071, LR: 0.001000
Epoch 354: 学习率调整为 0.000500
Epoch 400/2000, Loss: 0.001980, Recon Loss: 0.001857, LR: 0.000500
Epoch 450/2000, Loss: 0.001854, Recon Loss: 0.001732, LR: 0.000500
Epoch 480: 学习率调整为 0.000250
Epoch 500/2000, Loss: 0.001749, Recon Loss: 0.001649, LR: 0.000250
Epoch 550/2000, Loss: 0.001844, Recon Loss: 0.001735, LR: 0.000250
Epoch 572: 学习率调整为 0.000125
Epoch 600/2000, Loss: 0.001870, Recon Loss: 0.001777, LR: 0.000125
Epoch 650/2000, Loss: 0.001758, Recon Loss: 0.001652, LR: 0.000125
Epoch 669: 学习率调整为 0.000063
Epoch 700/2000, Loss: 0.001652, Recon Loss: 0.001554, LR: 0.000063
Epoch 720: 学习率调整为 0.000031
Epoch 750/2000, Loss: 0.001692, Recon Loss: 0.001579, LR: 0.000031
Epoch 771: 学习率调整为 0.000016
Epoch 800/2000, Loss: 0.001737, Recon Loss: 0.001625, LR: 0.000016
Epoch 850/2000, Loss: 0.001784, Recon Loss: 0.001682, LR: 0.000016
Epoch 862: 学习率调整为 0.000008
Epoch 900/2000, Loss: 0.001815, Recon Loss: 0.001721, LR: 0.000008
Epoch 950/2000, Loss: 0.001634, Recon Loss: 0.001544, LR: 0.000008
Epoch 966: 学习率调整为 0.000004
Epoch 1000/2000, Loss: 0.001683, Recon Loss: 0.001583, LR: 0.000004
Epoch 1017: 学习率调整为 0.000002
Epoch 1050/2000, Loss: 0.001761, Recon Loss: 0.001665, LR: 0.000002
Epoch 1068: 学习率调整为 0.000001
Epoch 1100/2000, Loss: 0.001776, Recon Loss: 0.001667, LR: 0.000001
Epoch 1119: 学习率调整为 0.000000
Epoch 1150/2000, Loss: 0.001679, Recon Loss: 0.001588, LR: 0.000000
Epoch 1170: 学习率调整为 0.000000
Epoch 1200/2000, Loss: 0.001838, Recon Loss: 0.001726, LR: 0.000000
Epoch 1221: 学习率调整为 0.000000
Epoch 1250/2000, Loss: 0.001724, Recon Loss: 0.001626, LR: 0.000000
Epoch 1272: 学习率调整为 0.000000
Epoch 1300/2000, Loss: 0.001773, Recon Loss: 0.001662, LR: 0.000000
Epoch 1323: 学习率调整为 0.000000
Epoch 1350/2000, Loss: 0.001708, Recon Loss: 0.001599, LR: 0.000000
Epoch 1374: 学习率调整为 0.000000
Epoch 1400/2000, Loss: 0.001720, Recon Loss: 0.001610, LR: 0.000000
Epoch 1450/2000, Loss: 0.001700, Recon Loss: 0.001599, LR: 0.000000
Epoch 1500/2000, Loss: 0.001647, Recon Loss: 0.001538, LR: 0.000000
Epoch 1550/2000, Loss: 0.001695, Recon Loss: 0.001589, LR: 0.000000
Epoch 1600/2000, Loss: 0.001708, Recon Loss: 0.001590, LR: 0.000000
Epoch 1650/2000, Loss: 0.001731, Recon Loss: 0.001603, LR: 0.000000
Epoch 1700/2000, Loss: 0.001744, Recon Loss: 0.001631, LR: 0.000000
Epoch 1750/2000, Loss: 0.001741, Recon Loss: 0.001640, LR: 0.000000
Epoch 1800/2000, Loss: 0.001753, Recon Loss: 0.001650, LR: 0.000000
Epoch 1850/2000, Loss: 0.001770, Recon Loss: 0.001657, LR: 0.000000
Epoch 1900/2000, Loss: 0.001724, Recon Loss: 0.001614, LR: 0.000000
Epoch 1950/2000, Loss: 0.001797, Recon Loss: 0.001692, LR: 0.000000
Epoch 2000/2000, Loss: 0.001723, Recon Loss: 0.001622, LR: 0.000000

训练完成，学习率共调整了 16 次
最佳损失: 0.001564
加载最佳模型进行测试...

📈 绘制训练损失曲线...
Loss curves saved to assets/loss_curves_4Lr[True]n6h1024ph1024E2000.png

============================================================
🧪 开始测试（使用真实数据）...
============================================================
测试数据维度: torch.Size([250, 1024])
压缩后维度: torch.Size([250, 256])
压缩率: 0.250

📊 整体测试结果:
  重建 MAE: nan
  重建 MSE: nan
  PSNR: nan dB

📸 生成可视化对比图（真实数据 vs 重建结果）...
Loss curves saved to assets/Example_4Lr[True]n6h1024ph1024E2000.png

📈 每张测试图像的详细指标:
  图像 1: PSNR = 18.49 dB, MAE = 0.086920, MSE = 0.014144
  图像 2: PSNR = 18.90 dB, MAE = 0.078484, MSE = 0.012880
  图像 3: PSNR = 15.86 dB, MAE = 0.111498, MSE = 0.025919
  图像 4: PSNR = 20.24 dB, MAE = 0.068011, MSE = 0.009457
  图像 5: PSNR = 14.85 dB, MAE = 0.143566, MSE = 0.032719

============================================================
✅ 测试完成！
  训练数据: 2000 张生成图像
  测试数据: 250 张真实图像
  压缩效果: 1024 维 → 256 维
  最佳模型已保存到: models/best_model.pth
============================================================
